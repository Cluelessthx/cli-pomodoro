# CLI Pomodoro Timer 🍅

一个美观的命令行番茄钟工具，支持多计时器并行、待办事项管理和系统通知。

## ✨ 功能特性

- **多计时器并行** - 同时运行多个倒计时，互不干扰
- **待办事项管理** - 创建、完成、追踪待办，数据自动持久化
- **计时器关联** - 创建待办时可关联计时器，完成后自动标记
- **实时进度显示** - Rich 进度条原地刷新，流畅美观
- **系统通知** - 计时结束时弹出桌面通知
- **数据持久化** - 待办自动保存到 JSON 文件
- **跨平台支持** - Windows、macOS、Linux 均可运行

## 🛠️ 技术栈

| 组件 | 技术 | 用途 |
|------|------|------|
| CLI 框架 | [Typer](https://typer.tiangolo.com/) | 命令行接口和参数解析 |
| 终端 UI | [Rich](https://rich.readthedocs.io/) | 进度条、表格、面板和样式输出 |
| 系统通知 | [Plyer](https://plyer.readthedocs.io/) | 跨平台桌面通知 |
| 异步运行 | asyncio | 多计时器并行执行 |
| 数据存储 | JSON | 待办事项持久化 |
| 开发语言 | Python 3.9+ | 核心实现 |

## 📁 项目结构

```
cli-pomodoro/
├── pomodoro.py    # 主入口和 CLI 命令
├── storage.py     # 数据模型（Todo, Timer）和 JSON 持久化
├── todo.py        # 待办事项管理器
├── timer.py       # 异步计时器管理器
├── ui.py          # Rich UI 组件
├── data/
│   └── todos.json # 待办数据文件
├── pyproject.toml # 项目配置
└── README.md
```

## 🚀 安装

```bash
# 克隆仓库
git clone https://github.com/Cluelessthx/cli-pomodoro.git
cd cli-pomodoro

# 安装依赖
pip install rich typer plyer
```

## 📖 使用方法

### 交互模式（推荐）

启动交互模式，支持多计时器并行和完整功能：

```bash
python pomodoro.py
# 或
python pomodoro.py run
```

#### 交互命令

| 命令 | 说明 |
|------|------|
| `add <分钟> [标题]` | 添加并启动新计时器 |
| `todo <标题>` | 添加待办（会询问是否关联计时器） |
| `watch` | 实时监控模式，按任意键退出 |
| `status` / `s` | 刷新显示当前状态 |
| `list` | 显示所有待办 |
| `done <id>` | 标记待办为已完成 |
| `del <id>` | 删除待办或计时器 |
| `pause <id>` | 暂停计时器 |
| `resume <id>` | 恢复暂停的计时器 |
| `clear` | 清除所有已完成的待办 |
| `help` | 显示帮助信息 |
| `quit` / `q` | 退出程序 |

### 经典单计时器模式

```bash
# 启动 25 分钟计时器（默认）
python pomodoro.py start

# 启动指定时长的计时器
python pomodoro.py start 30

# 启动带标题的计时器
python pomodoro.py start 25 --title "专注工作"
```

### 待办命令

```bash
# 添加待办
python pomodoro.py todo add "写文档"

# 添加待办并关联 25 分钟计时器
python pomodoro.py todo add "代码审查" --timer 25

# 查看待办列表
python pomodoro.py todo list

# 查看所有待办（包括已完成）
python pomodoro.py todo list --all

# 标记待办为完成
python pomodoro.py todo done <id>

# 删除待办
python pomodoro.py todo delete <id>

# 清除已完成的待办
python pomodoro.py todo clear
```

## 🖥️ 界面预览

### 计时器显示
```
                               <*> Active Timers
┌──────────┬───────────────┬───────────────────────────┬──────────┬───────────┐
│ ID       │ Title         │         Progress          │     Time │  Status   │
├──────────┼───────────────┼───────────────────────────┼──────────┼───────────┤
│ abc123   │ 专注工作      │   ========............    │    15:00 │  RUNNING  │
│ def456   │ 代码审查      │   ===.................    │    22:30 │  RUNNING  │
└──────────┴───────────────┴───────────────────────────┴──────────┴───────────┘
```

### 待办列表
```
                                 Pending Todos
┌──────────────┬──────────┬─────────────────────────────┬──────────────────────┐
│ ID           │  Status  │ Title                       │        Timer         │
├──────────────┼──────────┼─────────────────────────────┼──────────────────────┤
│ a1b2c3       │   [ ]    │ 写文档                      │         25m          │
│ d4e5f6       │   [v]    │ 审查 PR #123                │          -           │
└──────────────┴──────────┴─────────────────────────────┴──────────────────────┘
```

### 单计时器进度条
```
⠋ 专注工作 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 23:45 0:01:15
```

## 🏗️ 架构设计

```
用户输入
    │
    ▼
┌─────────────┐     ┌──────────────┐     ┌─────────────┐
│  pomodoro   │────▶│ TimerManager │────▶│     UI      │
│    .py      │     │   (异步)     │     │   (Rich)    │
└─────────────┘     └──────────────┘     └─────────────┘
    │                                           │
    ▼                                           ▼
┌─────────────┐     ┌──────────────┐       终端输出
│ TodoManager │────▶│   Storage    │
└─────────────┘     │   (JSON)     │
                    └──────────────┘
```

### 设计决策

- **异步架构** - 使用 `asyncio` 实现非阻塞的多计时器并行
- **模块化设计** - 存储、计时器、待办、UI 分离，职责清晰
- **Rich 集成** - 充分利用 Rich 库实现美观的终端输出
- **JSON 持久化** - 简单的文件存储，无需外部数据库

## ⚙️ 配置

默认设置：

| 配置项 | 默认值 | 说明 |
|--------|--------|------|
| 默认计时时长 | 25 分钟 | 标准番茄钟时长 |
| 数据目录 | `./data/` | JSON 文件存储位置 |
| 通知超时 | 10 秒 | 桌面通知显示时长 |

## 📋 系统要求

- Python 3.9+
- rich >= 13.0.0
- typer >= 0.9.0
- plyer >= 2.1.0

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交 Pull Request！
